# 1.8 Функции

## Функции

Функции в javascript это специальный тип объектов, с помощью которых можно задавать определенную логику для обработки данных.

Любая **функция это объект,** и следовательно ею можно манипулировать как объектом, в частности:

* передавать как аргумент и возвращать в качестве результата при вызове других функций
* создавать анонимно и присваивать в качестве значений переменных или свойств объектов.

### Объявление функций

#### function decloration

Объявление функции \(_function definition_, или _function declaration_, или _function statement_\) состоит из ключевого слова `function`, имя функции, параметров указываемых в `( )` и тела функции которое будет выполнено  после вызова.

Создадим функцию `add`

```javascript
function add(number) {
  return add + 1;
}
```

Функция add принимает один параметр number, добавляет к нему 1 и возвращает полученный результат.

Примитивные параметры переданные функции значением, не изменяются, но если передать объект и функция изменит его значения, то эти изменения отобразятся глобально.

```javascript
var x = 5;
var obj = {name: 'John'}
function sum(n) {
  n + 1
}
function changeObj(obj) {
  obj.name = 'Carl'
}
console.log(x) // 5
console.log(obj.name) // John
sum(x)
changeObj(obj)
console.log(x) // 5
console.log(obj.name) // Carl
```

#### function expression

Существует другой способ объявления функция который называется "функциональное выражение".

```javascript
var x = 5;
var sum = function(n) {
  n + 1
}

sum(5) // 6
```

Такая функция может быть анонимной, но можно и присвоить имя для рекурсии 

```javascript
var factorial = function fac(n) { return n < 2 ? 1 : n * fac(n - 1); };

console.log(factorial(3));
```

Function expression удобны для передачи аргументом.  Следующий пример показывает функцию `map`, которая должна получить функцию первым аргументом и массив вторым.

```javascript
function map(f, a) {
  var result = [], // Создание нового массива
  var i; // Создание переменной 
  for (i = 0; i != a.length; i++) 
    result[i] = f(a[i]); // применяет фунецию f для каждого элемента массива
  return result;
}

var f = function(x) { . // function expression
   return x * x * x; 
}
var numbers = [0, 1, 2, 5, 10];
var cube = map(f, numbers); // передаем аргументы 
```

В JavaScript функция может быть объявлена с условием. Например, следующая функция будет присвоена переменной `myFunc` только, если `data` равно `true`: 

```javascript
var myFunc;
var data = true;

if (data) {
  myFunc = function() {
    console.log("done")
  }
}
```

#### Конструктор Function

Для создания функции в рантайме можно использовать конструктор `Function`.

Конструктор `Function` создаёт новый объект `Function`. В JavaScript каждая функция является объектом `Function`.

```text
new Function([arg1[, arg2[, ...argN]],] functionBody)
```

Аргументы и тело функции должны быть строками.

```javascript
var adder = new Function('a', 'b', 'return a + b');

adder(2, 6) // 8
```

### Вызовы функций

Что бы выполнить действия написаные в теле функции ее нужно вызвать. К примеру так. 

```javascript
myFunc(1)
```

Этот вызов выполнит функцию с аргументом 1

Функции могут быть в области видимости, когда они уже определены, но функции вида "function declaration statment" могут быть подняты\(hoisting\), также как в этом примере:

```javascript
console.log(square(5)); //25

function square(n) { return n * n; }
```

c function expression будет следующий результат

```javascript
console.log(square); // square поднят со значением undefined.
console.log(square(5)); // TypeError: square is not a function
var square = function(n) { 
  return n * n; 
}
```

### Область видимости функций

Переменные объявленные в функции не могут быть доступными где-нибудь вне этой функции, поэтому переменные \(которые нужны именно для функции\) объявляют только в scope функции. При этом функция имеет доступ ко всем переменным и функциям, объявленным внутри её scope. Другими словами функция объявленная в глобальном scope имеет доступ ко всем переменным в глобальном scope. Функция объявленная внутри другой функции ещё имеет доступ и ко всем переменным её родителькой функции и другим переменным, к которым эта родительская функция имеет доступ.

```javascript
// Следующие переменные объявленны в глобальном scope
var num1 = 20,
    num2 = 3,
    name = 'Chamahk';

// Эта функция объявленна в глобальном scope
function multiply() {
  return num1 * num2;
}

multiply(); // вернет 60

// Пример вложенной функции
function getScore() {
  var num1 = 2,
      num2 = 3;
  
  function add() {
    return name + ' scored ' + (num1 + num2);
  }
  
  return add();
}

getScore(); // вернет "Chamahk scored 5"
```

### Scope и стек функции <a id="Scope_&#x438;_&#x441;&#x442;&#x435;&#x43A;_&#x444;&#x443;&#x43D;&#x43A;&#x446;&#x438;&#x438;"></a>



